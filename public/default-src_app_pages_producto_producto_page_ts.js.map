{"version":3,"file":"default-src_app_pages_producto_producto_page_ts.js","mappings":"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","sources":["./src/app/pages/producto/producto.page.ts","./src/app/services/carrito.service.ts","./src/app/services/pedidos.service.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { ModalController, NavController } from '@ionic/angular';\r\nimport { PedidosService } from 'src/app/services/pedidos.service';\r\nimport { ProductosService } from 'src/app/services/productos.service';\r\nimport { UsuarioService } from 'src/app/services/usuario.service';\r\nimport { Storage } from '@ionic/storage-angular';\r\nimport { CarritoService } from 'src/app/services/carrito.service';\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'app-producto',\r\n  templateUrl: './producto.page.html',\r\n  styleUrls: ['./producto.page.scss'],\r\n})\r\nexport class ProductoPage implements OnInit {\r\n\r\n  producto: any = {\r\n    _id: \"\",\r\n    nombre: \"\",\r\n    url: \"\",\r\n    estado: true,\r\n    usuario: {\r\n      _id: \"\",\r\n      nombre: \"\"\r\n    },\r\n    precio: 0,\r\n    stock: 0,\r\n    categoria: {\r\n      _id: \"\",\r\n      nombre: \"\"\r\n    },\r\n    etiquetas: [\r\n      \"\"\r\n    ],\r\n    descripcion: \"\",\r\n    img: [\r\n      \"\"\r\n    ]\r\n  };\r\n\r\n  constructor(private modalCtrl: ModalController, private activateRoute: ActivatedRoute, private productosService: ProductosService, private navCtrl: NavController, private pedidosService: PedidosService, private usuarioService: UsuarioService, private storage: Storage, private carritoService: CarritoService) {\r\n    this.storage.create();\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n    this.activateRoute.params.subscribe(async ({ tituloProductoUrl }) => {\r\n      await this.productosService.getProductoSlug(tituloProductoUrl)\r\n        .then(producto => {\r\n          this.producto = producto;\r\n          this.producto = this.producto.producto;\r\n          if (this.producto == undefined) {\r\n            this.navCtrl.navigateRoot('/');\r\n          }\r\n        });\r\n    });\r\n  }\r\n\r\n  salirSinArgumentos() {\r\n    this.modalCtrl.dismiss();\r\n  }\r\n\r\n  salirConArgumentos() {\r\n    this.modalCtrl.dismiss({\r\n      nombre: 'disponible',\r\n      precio: 200\r\n    })\r\n  }\r\n\r\n  async comprar() {\r\n\r\n    await this.usuarioService.cargarToken();\r\n    await this.usuarioService.validaToken();\r\n\r\n    if (this.usuarioService.usuario.nombre == undefined) {\r\n      await this.storage.set('url', this.producto.url);\r\n      this.navCtrl.navigateRoot('/login');\r\n    } else {\r\n      await this.carritoService.agregarProductoCarrito(this.producto._id).then(console.log).catch(console.log);\r\n    }\r\n\r\n  }\r\n\r\n}\r\n","import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\n\nimport { environment } from 'src/environments/environment';\nimport { UsuarioService } from './usuario.service';\nimport { WebsocketService } from './websocket.service';\n\n\nconst URL = environment.url;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CarritoService {\n\n  constructor(private http: HttpClient, private wsService: WebsocketService, private usuarioService: UsuarioService) { }\n\n  obtenerCarrito() {\n    return new Promise<boolean>(resolve => {\n      this.http.get(`${URL}/carrito`)\n        .subscribe(resp => {\n          if (resp['ok']) {\n            resolve(resp['carrito']);\n          } else {\n            resolve(false);\n          }\n        });\n    });\n  }\n\n  async agregarProductoCarrito(producto) {\n\n    await this.usuarioService.cargarToken();\n\n    const data = {\n      \"producto\": producto\n    }\n\n    const headers = new HttpHeaders({\n      'x-token': this.usuarioService.token\n    });\n    return new Promise(resolve => {\n      this.http.post(`${URL}/carrito`, data, { headers })\n        .subscribe(resp => {\n          if (resp['ok']) {\n            resolve(resp);\n          } else {\n            resolve(false);\n          }\n        }, (err) => {\n          resolve(err);\n        });\n    });\n  }\n\n  async borrarProductoCarrito(idcarrito) {\n\n    await this.usuarioService.cargarToken();\n\n    const headers = new HttpHeaders({\n      'x-token': this.usuarioService.token\n    });\n\n    return new Promise(resolve => {\n      this.http.delete(`${URL}/carrito/${idcarrito}`, { headers })\n        .subscribe(async resp => {\n          if (resp['ok']) {\n            resolve(true);\n          } else {\n            resolve(false);\n          }\n        }, (err) => {\n          resolve(err);\n        });\n    });\n  }\n\n  obtenerProductosCarrito(idUsuario) {\n    this.wsService.emit('get-productos-carrito', idUsuario);\n    return this.wsService.listen('productos-carrito');\n  }\n\n  async pagar(productos) {\n\n    await this.usuarioService.cargarToken();\n\n    const data = {\n      \"productos\": productos\n    }\n    \n    const headers = new HttpHeaders({\n      'x-token': this.usuarioService.token\n    });\n    return new Promise(resolve => {\n      this.http.post(`${URL}/pedidos/linkPago`, data, { headers })\n        .subscribe(resp => {\n          if (resp['ok']) {\n            resolve(resp);\n          } else {\n            resolve(false);\n          }\n        }, (err) => {\n          resolve(err);\n        });\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PedidosService {\n\n  productosCarrito: any;\n\n  constructor() {\n   \n  }\n\n  comprarProductos(productos) {\n    console.log(productos)\n  }\n\n\n\n}\n"],"names":["Component","ActivatedRoute","ModalController","NavController","PedidosService","ProductosService","UsuarioService","Storage","CarritoService","ProductoPage","constructor","modalCtrl","activateRoute","productosService","navCtrl","pedidosService","usuarioService","storage","carritoService","_id","nombre","url","estado","usuario","precio","stock","categoria","etiquetas","descripcion","img","create","ngOnInit","params","subscribe","tituloProductoUrl","getProductoSlug","then","producto","undefined","navigateRoot","salirSinArgumentos","dismiss","salirConArgumentos","comprar","cargarToken","validaToken","set","agregarProductoCarrito","console","log","catch","selector","template","HttpClient","HttpHeaders","Injectable","environment","WebsocketService","URL","http","wsService","obtenerCarrito","Promise","resolve","get","resp","data","headers","token","post","err","borrarProductoCarrito","idcarrito","delete","obtenerProductosCarrito","idUsuario","emit","listen","pagar","productos","providedIn"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}